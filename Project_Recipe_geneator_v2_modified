import requests
import os
# Register to get an API key https://developer.edamam.com/edamam-recipe-api
api_id = os.environ.get("edamam_api_id")
api_key = os.environ.get("edamam_api_key")

def recipe_search (ingredient, Health, Diet):
    result = requests.get('https://api.edamam.com/search?q={}&Health={}&Diet={}&app_id={}&app_key={}'.format(ingredient, Health, Diet, api_id, api_key))
    data = result.json()
    return data['hits']

### Diet- balanced, high-protein,  low-carb, low-fat
### Health- vegan,  vegetarian, sugar-conscious, peanut-free, tree-nut-free,  alcohol-free

def run ():
    User_ingredient = input("Hello! What ingredients do you want to cook? ")
    ingredient = User_ingredient.lower()
    dietary_requirements = input("Do you have any dietary requirements? y/n  ")
    if dietary_requirements == "y":
        User_Health = input("Please enter your requirement: vegan,  vegetarian, sugar-conscious, peanut-free, tree-nut-free or alcohol-free  ")
        Health = User_Health.lower()
        User_Diet = input("What diet type are you following?  balanced, high-protein, low-carb, low-fat   ")
        Diet = User_Diet.lower()

    elif dietary_requirements == "n":
        Health = ""
        Diet = ""


    print()
    print("With the ingredients: {}, taking into account you want {} food, we found the following {} recipes for you : ".format(ingredient, Health, Diet))

    recipes = recipe_search(ingredient, Health, Diet)
    i = 0

    for recipe in recipes:
        i = i +1
        print(i, recipe['recipe']['label'])
        print(recipe['recipe']['url'])
        print()
    print("In total you have {} options of recipes".format(i))

run()


def export_results():
    with open('my_recipes.txt', 'r') as read_file:
        my_recipes = read_file.read()

    print("Your current list of recipes contains: ")
    print(my_recipes)

    with open('my_recipes.txt', 'w+') as write_recipe:
        recipe_number = input("Which recipe do you want to add? (Just write the number)   ")
        write_recipe.write(my_recipes+"\n"+recipe_number)

    with open('my_recipes.txt', 'r') as read_file:
        my_recipes = read_file.read()

    print("Your new list is: ")
    print(my_recipes)


ask_export = input("Would you like to export one? y/n   ")
if ask_export == "y":
    export_results()
elif ask_export == "n":
    print("All right, good luck with your cooking!")

